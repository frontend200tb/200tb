<article class="article">
  <h1>Лекция 21 (26.05.2025)</h1>
</article>

<div id="link-to-dsr2024cpp" class="btn-back">назад</div>


<!-- Содержание -->
<article class="article">
  <h2>Содержание</h2>

  <p><a href="#p1">Задание на курсовой проект</a></p>
  <p><a href="#p2">Проектирование системы</a></p>
  <p><a href="#p3">План реализации игры</a></p>
  <p><a href="#p4">Реализация основных классов</a></p>
  <p><a href="#p5">Основная логика игры</a></p>
  <p><a href="#p6">Дополнительные системы</a></p>
  <p><a href="#p7">Интерфейс пользователя</a></p>
</article>


<!-- Задание на курсовой проект -->
<article class="article">
  <div class="anchor" id="p1"></div>
  <h3>Задание на курсовой проект</h3>

  <p>В данной игре пользователь управляет персонажем по имени Эш Кэтчем — тренером покемонов. Игровое поле представляет собой сетку, аналогичную шахматной доске. Эш может перемещаться по ней вверх, вниз, влево и вправо.</p>
  <p>В начале игры игроку предлагается выбрать <strong>трёх покемонов</strong>, которые будут составлять его команду. Каждый покемон обладает своими характеристиками: уровнем, очками здоровья, типом атаки и способностями.</p>
  <p>Каждая клетка поля может содержать один из следующих элементов:</p>
  <ol>
    <li><strong>Вражеские покемоны</strong> — от 1 до 3 штук. При встрече с ними начинается <strong>пошаговый бой</strong>. В каждом раунде игрок выбирает действия для своих покемонов: атаковать, использовать способность или пропустить ход. После действий игрока ход переходит к противнику. Побеждая врагов, покемоны получают <strong>опыт</strong>, который накапливается и позволяет им <strong>повышать уровень</strong>. С каждым новым уровнем улучшаются характеристики покемона (например, здоровье, урон, скорость). При достижении определённого уровня покемон может <strong>эволюционировать</strong> — перейти в новую, более мощную форму с улучшенными способностями и внешним видом.</li>
    <li><strong>Стена</strong> — препятствие, через которое нельзя пройти.</li>
    <li><strong>Обычная клетка</strong> — свободное пространство, по которому можно перемещаться.</li>
    <li><strong>Зелье восстановления</strong> — при попадании на такую клетку здоровье всех покемонов игрока полностью восстанавливается.</li>
  </ol>
  <p><strong>Цель игры</strong>: победить всех вражеских покемонов на карте и остаться в живых.</p>

  <hr>

  <h4>Требования к реализации:</h4>

  <ol>
    <li>Использование изученных в курсе структур данных</li>
    <li>Применение паттернов проектирования</li>
    <li>Реализация пошаговой боевой системы</li>
    <li>Продуманная система прокачки и эволюции покемонов</li>
    <li>Продуманный интерфейс</li>
  </ol>

  <hr>

  <h4>Дополнительные задания (по желанию):</h4>

  <ol>
    <li><strong>Сохранение и загрузка игры</strong> — реализовать систему сохранения текущего состояния игры (положение Эша, состояние карты, здоровье и уровень покемонов, опыт и т. д.) в файл, с возможностью последующего восстановления с этого места.</li>
    <li><strong>Разнообразие карт</strong> — возможность выбора или случайной генерации карты.</li>
    <li><strong>Модификаторы погоды или условий боя</strong> — которые влияют на эффективность атак (например, дождь усиливает водные атаки).</li>
    <li><strong>Уровни сложности</strong> — выбор начального уровня сложности, влияющего на количество врагов, их силу и частоту появления зелий восстановления.</li>
  </ol>
</article>


<!-- Проектирование системы -->
<article class="article">
  <div class="anchor" id="p2"></div>
  <h3>Проектирование системы</h3>

  <p>Мы начнем с проектирования системы, используя объектно-ориентированный подход и паттерны проектирования.</p>
  <p>Основные классы:</p>
  <ol>
    <li>
      `Ash` - игрок, который управляется пользователем. Содержит:
      <ul>
        <li>Позицию на карте (x, y)</li>
        <li>Команду покемонов (массив из 3 покемонов)</li>
      </ul>
    </li>
    <li>
      `Pokemon` - базовый класс для покемонов. Содержит:
      <ul>
        <li>Имя</li>
        <li>Уровень</li>
        <li>Очки здоровья (HP)</li>
        <li>Максимальное здоровье</li>
        <li>Тип атаки (например, огонь, вода, трава и т.д.)</li>
        <li>Список способностей (атак)</li>
        <li>Опыт</li>
        <li>Опыт до следующего уровня</li>
      </ul>
      Методы:
      <ul>
        <li>`attack(Pokemon& target, Ability& ability)` - атаковать другого покемона выбранной способностью.</li>
        <li>`gainExp(int amount)` - получить опыт, при достижении порога - повышение уровня.</li>
        <li>`levelUp()` - повышение уровня: улучшение характеристик и, возможно, эволюция.</li>
      </ul>
      Также можно использовать паттерн "Состояние" для эволюции, но для простоты сделаем проверку в `levelUp`.
    </li>
    <li>
      `Ability` - способность (атака). Содержит:
      <ul>
        <li>Название</li>
        <li>Урон</li>
        <li>Тип (соответствует типу покемона для расчета эффективности)</li>
        <li>(дополнительно: количество использований, если ограничено)</li>
      </ul>
    </li>
    <li>
      `Map` - игровая карта. Содержит:
      <ul>
        <li>Двумерный массив клеток (сетка)</li>
        <li>Размеры карты</li>
      </ul>
      Клетка (класс `Cell` или просто перечисление) может быть:
      <ul>
        <li>Пустая</li>
        <li>Стена</li>
        <li>Зелье восстановления</li>
        <li>Вражеские покемоны (от 1 до 3)</li>
      </ul>
      Для вражеских покемонов в клетке можно хранить вектор покемонов.
    </li>
    <li>
      `Game` - основной класс игры, управляющий потоком игры. Содержит:
      <ul>
        <li>Объект `Ash`</li>
        <li>Объект `Map`</li>
        <li>Текущее состояние игры (меню, ходьба, бой и т.д.)</li>
      </ul>
      Методы:
      <ul>
        <li>`start()` - запуск игры</li>
        <li>`gameLoop()` - главный цикл</li>
        <li>`battle(std::vector&lt;Pokemon&gt;& enemyPokemons)` - вступить в бой с вражескими покемонами</li>
      </ul>
    </li>
    <li>
      `BattleSystem` - класс, управляющий боем. Можно реализовать как состояние игры. Использует пошаговую систему. Бой:
      <ul>
        <li>Инициатива (скорость покемонов) определяет порядок хода.</li>
        <li>В каждом раунде игрок выбирает действие для каждого своего покемона (атака, способность, пропуск).</li>
        <li>Затем ходят вражеские покемоны (ИИ: случайные действия).</li>
      </ul>
      После победы покемоны игрока получают опыт.
    </li>
    <li>
      `Persistence` - класс для сохранения и загрузки игры (если реализуем дополнительное задание). Паттерны, которые можно применить:
      <ul>
        <li>Состояние (State): для смены состояний игры (меню, исследование, бой).</li>
        <li>Стратегия (Strategy): для ИИ врагов (разные стратегии боя).</li>
        <li>Фабрика (Factory): для создания покемонов и карт.</li>
        <li>Наблюдатель (Observer): для системы событий (например, при эволюции покемона).</li>
      </ul>
      Интерфейс: консольный, с использованием `std::cout` и `std::cin`.
    </li>
  </ol>
  <p>Это базовая реализация. Многое можно улучшить:</p>
  <ul>
    <li>Добавить больше типов клеток.</li>
    <li>Реализовать систему сохранения (сериализовать состояние игры в файл).</li>
    <li>Добавить уровни сложности, влияющие на количество и силу врагов.</li>
    <li>Реализовать модификаторы погоды в бою.</li>
  </ul>

  <h4>Дополнительные задания:</h4>

  <ol>
    <li>Сохранение игры: можно использовать текстовый или бинарный формат. Сохраняем позицию Эша, состояние карты (каждая клетка), состояние каждого покемона в команде (имя, уровень, здоровье, опыт и т.д.) и врагов на карте.</li>
    <li>Генерация карты: можно создать несколько предопределенных карт или генерировать случайно.</li>
    <li>Модификаторы погоды: добавить в бой состояние погоды, которое влияет на урон атак определенного типа.</li>
    <li>Уровни сложности: при старте игры спрашивать уровень сложности и на его основе настраивать параметры врагов и карты.</li>
  </ol>
</article>


<!-- План реализации -->
<article class="article">
  <div class="anchor" id="p3"></div>
  <h3>План реализации игры "Эш Кэтчем: Тренер Покемонов"</h3>

  <h4>Основные компоненты:</h4>

  <ol>
    <li>Класс Ash - управление позицией и командой покемонов</li>
    <li>Класс Pokemon - характеристики и поведение покемонов</li>
    <li>Класс Map - игровое поле с клетками разных типов</li>
    <li>Класс BattleSystem - пошаговая боевая система</li>
    <li>Класс Game - управление игровым процессом</li>
  </ol>

  <h4>Ключевые структуры данных:</h4>

  <ol>
    <li>std::vector для команды покемонов и врагов</li>
    <li>std::map для хранения информации о эволюциях</li>
    <li>Двумерный массив (сетка) для игрового поля</li>
  </ol>

  <h4>Паттерны проектирования:</h4>

  <ol>
    <li>Фабричный метод - создание покемонов</li>
    <li>Стратегия - выбор атак в бою</li>
    <li>Наблюдатель - система событий (эволюция)</li>
    <li>Состояние - управление игровыми режимами</li>
  </ol>
</article>


<!-- Реализация основных классов -->
<article class="article">
  <div class="anchor" id="p4"></div>
  <h3>Реализация основных классов</h3>

  <h4>1. Класс Pokemon (pokemon.h)</h4>

  <h4>2. Класс Ash (ash.h)</h4>

  <h4>3. Класс Map (map.h)</h4>

  <h4>4. Класс BattleSystem (battle_system.h)</h4>

  <h4>5. Класс Game (game.h)</h4>

</article>


<!-- Основная логика игры -->
<article class="article">
  <div class="anchor" id="p5"></div>
  <h3>Основная логика игры</h3>

  <ol>
    <li>
      Главное меню:
      <ul>
        <li>Новая игра</li>
        <li>Загрузка сохранения</li>
        <li>Настройка сложности</li>
        <li>Выход</li>
      </ul>
    </li>
    <li>
      Меню сложности:
      <ul>
        <li>Легкий (меньше врагов, больше зелий)</li>
        <li>Средний</li>
        <li>Сложный (больше врагов, сложные бои)</li>
      </ul>
    </li>
    <li>
      Экран выбора покемонов:
      <ul>
        <li>Игрок выбирает 3 стартовых покемона</li>
        <li>Каждый тип имеет свои преимущества и недостатки</li>
      </ul>
    </li>
    <li>
      Логика работы при запуске новой игры:
      <ul>
        <li>Устанавливается сложность</li>
        <li>Выбираются покемоны</li>
        <li>Создается экземпляр игры</li>
      </ul>
    </li>
    <li>
      Логика работы при загрузке:
      <ul>
        <li>Загружаются данные из файла</li>
        <li>Восстанавливается состояние игры</li>
      </ul>
    </li>
  </ol>

</article>


<!-- Дополнительные системы -->
<article class="article">
  <div class="anchor" id="p6"></div>
  <h3>Дополнительные системы</h3>
</article>


<!-- Интерфейс пользователя -->
<article class="article">
  <div class="anchor" id="p7"></div>
  <h3>Интерфейс пользователя</h3>

  <ol>
    <li>
      Главное меню:
      <ul>
        <li>Начать новую игру</li>
        <li>Загрузить игру</li>
        <li>Настройки сложности</li>
        <li>Выход</li>
      </ul>
    </li>
    <li>
      Экран выбора покемонов:
      <ul>
        <li>Показ 6 стартовых покемонов</li>
        <li>Выбор 3 для команды</li>
      </ul>
    </li>
    <li>
      Игровой экран:
      <ul>
        <li>Отображение карты (символьная графика)</li>
        <li>Панель статуса команды</li>
        <li>Индикаторы здоровья и уровней</li>
      </ul>
    </li>
    <li>
      Боевой интерфейс:
      <ul>
        <li>Выбор действия для каждого покемона</li>
        <li>Отображение эффективности атак</li>
        <li>Анимации эффектов погоды</li>
      </ul>
    </li>
  </ol>
</article>

