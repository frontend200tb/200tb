<!-- Задача C. Обмены -->
<div><i>Ограничение по времени 2с
<br>Ограничение по памяти 256мб</i></div>

<p>За круглым столом сидят n игроков. У всех них в сумме s карт n цветов, причем на начальный момент у первого человека карты только первого цвета, у второго — второго цвета и так далее. Они могут меняться картами, согласно следующим правилам:</p>
<ul>
  <li>человек может отдавать в процессе обмена карту только своего цвета;</li>
  <li>игрок не может брать карту цвета, уже у него имеющегося (в частности, карты своего цвета он брать не может, независимо от того раздал он их все или нет);</li>
  <li>в процессе одного обмена пара людей обменивается картами (каждый человек отдает одну карту и получает одну карту).</li>
</ul>
<p>Цель всех n человек: каждый из них должен отдать все карты, которые были у него в начале (то есть все карты своего цвета). Ваша задача указать, возможна ли такая последовательность обменов. Если ответ положительный, нужно указать все обмены.</p>

<h4>Входные данные</h4>
<p>В первой строке записаны целые числа n (1 ≤ n ≤ 200000) и s (1 ≤ s ≤ 200000). Вторая строка содержит n чисел — количество карт у 1-го, 2-го, ..., n-го игрока на момент начала игры. Игрок может не иметь карт вообще на момент начала игры.</p>

<h4>Выходные данные</h4>
<p>Выведите в первой строке «No», если такая последовательность обменов невозможна, и «Yes» в противном случае. Если ответ положительный, выведите далее число k — количество обменов. Далее в k строках опишите обмены — парой номеров меняющихся игроков. Обмены и номера в обменах выводите в любом порядке.</p>

<details>
  <summary>Примеры</summary>
<h4>Пример 1</h4>
<pre>
4 8
2 2 2 2
</pre>
<pre>
Yes
4
4 3
4 2
1 3
1 2
</pre>

<h4>Пример 2</h4>
<pre>
6 12
1 1 2 2 3 3
</pre>
<pre>
Yes
6
6 5
6 4
6 3
5 4
5 3
2 1
</pre>

<h4>Пример 3</h4>
<pre>
5 5
0 0 0 0 5
</pre>
<pre>
No
</pre>
</details>

<details>
  <summary>Решение</summary>

  <div>
    <a href="https://codeforces.com/contest/134/problem/C" target="_blank">Задача 134C</a>
    <br><a href="https://codeforces.com/contest/134" target="_blank">Codeforces Testing Round 3 2011-11-30</a>
  </div>

<pre>
#include &lt;iostream&gt;
#include &lt;queue>
#include &lt;vector>

using namespace std;

int main() {
// условная компиляция
#ifdef _DEBUG
  freopen("input.txt", "rt", stdin);
  freopen("output.txt", "wt", stdout);
#endif

  // ввод данных
  int n; // число цветов
  int s; // число карт
  cin >> n >> s;
  vector&lt;int> A(n + 1); // число карт у каждого игрока
  for (int i = 1; i &lt;= n; i++) {
    cin >> A[i];
  }

  // решение
  priority_queue&lt;pair&lt;int, int> > q;
  for (int i = 1; i &lt;= n; i++) {
    if (A[i]) q.push(make_pair(A[i], i));
  }
  vector&lt;pair&lt;int, int> > ret;
  while (!q.empty()) {
    pair&lt;int, int> fu = q.top();
    q.pop();
    vector&lt;pair&lt;int, int> > tmp;
    while (fu.first > 0) {
      if (q.empty()) {
        cout &lt;&lt; "No\n";
        return 0;
      }

      pair&lt;int, int> fv = q.top();
      q.pop();
      ret.push_back(make_pair(fu.second, fv.second));
      fv.first--;
      fu.first--;
      if (fv.first > 0) {
        tmp.push_back(fv);
      }
    }
    for (int i = 0; i &lt; tmp.size(); i++) {
      q.push(tmp[i]);
    }
  }

  // вывод результата
  cout &lt;&lt; "Yes\n";
  cout &lt;&lt; ret.size() &lt;&lt; '\n';
  for (int i = 0; i &lt; ret.size(); i++) {
    cout &lt;&lt; ret[i].first &lt;&lt; ' ' &lt;&lt; ret[i].second &lt;&lt; '\n';
  }
}
</pre>
</details>
