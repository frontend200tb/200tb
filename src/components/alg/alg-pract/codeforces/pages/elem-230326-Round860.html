<article class="article">
  <p><a href="https://codeforces.com/contest/1798" target="_blank">Codeforces Round 860 (Div. 2) 2023-03-26</a></p>
</article>


<!-- Содержание -->
<article class="article">
  <h2>Содержание</h2>

  <p>
        <a href="#task1">Задача A. Гвоздь программы</a>
    <br><a href="#task2">Задача B. Три семёрки</a>
    <br><a href="#task3">Задача C. Магазин сладостей</a>
    <br><a href="#task4">Задача D. Шокирующая расстановка</a>
    <br><a href="#task5">Задача E. Генератор мультитестов</a>
    <br><a href="#task6">Задача F. Подарки от Деда Ахмеда</a>
  </p>
</article>


<!-- Задача A. Гвоздь программы -->
<article class="article">
  <div class="anchor" id="task1"></div>
  <h3>Задача A. Гвоздь программы</h3>

  <div><i>Ограничение по времени 2с
  <br>Ограничение по памяти 256мб</i></div>

  <p>Вам даны два массива a1,a2,…,an и b1,b2,…,bn.</p>

  <p>За одну операцию можно выбрать любое число i от 1 до n и поменять местами числа ai и bi.</p>

  <p>Определите, можно ли после использования некоторого (возможно, нулевого) количества операций добиться одновременного выполнения следующих двух условий:</p>
  <ul>
    <li>an=max(a1,a2,…,an),</li>
    <li>bn=max(b1,b2,…,bn).</li>
  </ul>

  <p>Здесь запись max(c1,c2,…,ck) обозначает максимальное из чисел c1,c2,…,ck. Например max(3,5,4)=5, max(1,7,7)=7, max(6,2)=6.</p>

  <h4>Входные данные</h4>
  <p>Каждый тест состоит из нескольких наборов входных данных. В первой строке находится одно целое число t (1 ≤ t ≤ 200) — количество наборов входных данных. Далее следует описание наборов входных данных.</p>

  <p>Первая строка каждого набора входных данных содержит одно целое число n (1 ≤ n ≤ 100) — длина массивов.</p>

  <p>Вторая строка каждого набора входных данных содержит n
  целых чисел a1,a2,…,an (1 ≤ ai ≤ 100) — элементы первого массива.</p>

  <p>Третья строка каждого набора входных данных содержит n целых чисел b1,b2,…,bn (1 ≤ bi ≤ 100) — элементы второго массива.</p>

  <h4>Выходные данные</h4>
  <p>Для каждого набора входных данных в отдельной строке выведите «Yes», если после применения некоторого (возможно, нулевого) количества операций можно добиться выполнения описанных условий. В противном случае выведите «No».</p>

  <p>Вы можете выводить каждую букву в любом регистре (строчную или заглавную). Например, строки «yEs», «yes», «Yes» и «YES» будут приняты как положительный ответ.</p>

  <h4>Пример</h4>
<pre>
7
3
7 9 7
7 6 9
4
10 10 15 15
10 16 15 15
2
100 99
99 100
1
1
1
9
1 2 3 4 5 6 7 8 9
9 9 9 9 9 9 6 6 6
7
1 1 2 2 1 1 2
1 2 1 2 1 2 1
2
30 4
5 30
</pre>
<pre>
Yes
No
Yes
Yes
Yes
No
No
</pre>
  <p>В первом наборе входных данных можно поменять местами числа a3 и b3, после чего массив a станет равным [7,9,9], а массив b станет равным [7,6,7] и оба условия будут выполнены.</p>
  <p>Во втором наборе входных данных можно показать, что выполнить условия невозможно.</p>
  <p>В третьем наборе входных данных можно поменять местами числа a1 и b1, после чего массив a станет равным [99,99], а массив b станет равным [100,100] и оба условия будут выполнены.</p>
  <p>В пятом наборе входных данных можно поменять местами a7 и b7 , a8 и b8, a9 и b9, после чего массив a станет равным [1,2,3,4,5,6,6,6,6], а массив b станет равным [9,9,9,9,9,9,7,8,9] и оба условия будут выполнены.</p>
</article>


<!-- Задача B. Три семёрки -->
<article class="article">
  <div class="anchor" id="task2"></div>
  <h3>Задача B. Три семёрки</h3>

  <div><i>Ограничение по времени 2с
  <br>Ограничение по памяти 256мб</i></div>

  <p>Лотерея «Три Семёрки» проводилась m дней. В день i в лотерее участвовали ni людей с номерами ai,1,…,ai,ni.</p>

  <p>Известно, что в каждый из m дней из участников лотереи выбирался ровно один победитель. Победителю лотереи в день i запрещено участвовать в лотерее в дни с номерами от i+1 до m.</p>

  <p>К сожалению, информация о победителях лотереи была утеряна. Вам нужно восстановить любой возможный список победителей лотереи в дни с номерами от 1 до m или определить, что это невозможно.</p>

  <h4>Входные данные</h4>
  <p>Каждый тест состоит из нескольких наборов входных данных. В первой строке находится одно целое число t (1≤t≤50000) — количество наборов входных данных. Далее следует описание наборов входных данных.</p>

  <p>Первая строка каждого набора входных данных содержит одно целое число m (1≤m≤50000) — количество дней, в которые проводилась лотерея.</p>

  <p>Далее для каждого i от 1 до m находится блок данных из двух строк.</p>

  <p>В первой строке каждого блока находится одно целое число ni (1≤ni≤50000) — количество участников лотереи в день i.</p>

  <p>Во второй строке блока находятся числа ai,1,…,ai,ni (1≤ai,j≤50000) — номера участников лотереи в день i. Гарантируется, что все числа ai,1,…,ai,ni попарно различны.</p>

  <p>Гарантируется, что сумма значений ni по всем блокам всех наборов входных данных не превосходит 50000.</p>

  <h4>Выходные данные</h4>
  <p>Для каждого набора входных данных, если решения не существует, выведите одно целое число -1.</p>

  <p>Иначе выведите m целых чисел p1,p2,…,pm (1≤pi≤50000) — номера победителей лотереи в дни с 1 по m. Если существует несколько корректных решений, выведите любое из них.</p>

  <h4>Пример</h4>
<pre>
3
3
4
1 2 4 8
3
2 9 1
2
1 4
2
2
1 2
2
2 1
4
4
1 2 3 4
1
1
1
4
1
3
</pre>
<pre>
8 2 1
-1
2 1 4 3
</pre>
  <p>В первом наборе входных данных один из подходящих ответов [8,2,1], так как участник с номером 8 участвовал в день 1, но не участвовал в дни 2 и 3; участник с номером 2 участвовал в день 2, но не участвовал в день 3; а участник с номером 1 участвовал в день 3. Обратите внимание, что это не единственный возможный ответ, например, [8,9,4] также является верным ответом.</p>
  <p>Во втором наборе входных данных оба участника лотереи участвовали в обоих днях лотереи, значит любой возможный победитель лотереи в день 1 обязательно участвовал в день 2, значит подходящего ответа не существует.</p>
  <p>В третьем наборе входных данных в дни 2, 3 и 4 участвовал только один участник, а в день 1  единственный участник, не участвовавший в лотерее в днях 2,3,4 — это участник 2. Значит [2,1,4,3] — единственно верный ответ.</p>
</article>


<!-- Задача C. Магазин сладостей -->
<article class="article">
  <div class="anchor" id="task3"></div>
  <h3>Задача C. Магазин сладостей</h3>

  <div><i>Ограничение по времени 3с
  <br>Ограничение по памяти 256мб</i></div>

  <p>В магазине продаётся n типов конфет с номерами от 1 до n. Одна конфета типа i стоит bi монет. Всего в магазине есть ai конфет типа i.</p>

  <p>Вам необходимо расфасовать все конфеты по пачкам, каждая пачка должна состоять только из конфет одного типа. Формально, для каждого типа конфет i вам необходимо выбрать число di, обозначающее количество конфет типа i в одной пачке, так, чтобы ai делилось без остатка на di.</p>

  <p>Тогда стоимость одной пачки конфет типа i будет равна bi⋅di. Обозначим эту стоимость за ci, то есть ci=bi⋅di.</p>

  <p>После расфасовки пачки конфет будут помещены на полку. Рассмотрим стоимости пачек, расположенных на полке, в порядке c1,c2,…,cn. Для описания стоимостей будут использоваться ценники. Один ценник может описать стоимость всех товаров от l до r включительно, если cl=cl+1=…=cr. Каждый из товаров от 1 до n должен быть описан хотя бы одним ценником. К примеру, если c1,…,cn=[4,4,2,4,4], для описания всех товаров будет достаточно 3 ценника, первый ценник описывает товары 1,2, второй: 3, третий: 4,5.</p>

  <p>Вам даны числа a1,b1,a2,b2,…,an,bn. Ваша задача выбрать числа di так, чтобы ai делилось на di для всех i, и необходимое количество ценников для описания стоимостей c1,c2,…,cn было минимально возможным.</p>

  <p>Для лучшего понимания условия ознакомьтесь с иллюстрацией первого набора входных данных первого теста:</p>
  <code>a[1]=20, b[1]=3, d[1]=4, c[1]=12</code>
  <code>a[2]=6, b[2]=2, d[2]=6, c[2]=12</code>
  <code>a[3]=14, b[3]=5, d[3]=7, c[3]=35</code>
  <code>a[4]=20, b[4]=7, d[4]=5, c[4]=35</code>
  <p>Повторим смысл используемых в задаче обозначений:</p>
  <p>ai — количество конфет типа i имеющихся в магазине.</p>
  <p>bi — стоимость одной конфеты типа i.</p>
  <p>di — количество конфет типа i в одной пачке.</p>
  <p>ci — стоимость одной пачки конфет типа i, выражается по формуле ci=bi⋅di.</p>

  <h4>Входные данные</h4>
  <p>Каждый тест состоит из нескольких наборов входных данных. В первой строке находится одно целое число t (1≤t≤100000) — количество наборов входных данных. Далее следует описание наборов входных данных.</p>

  <p>Первая строка каждого набора входных данных содержит одно целое число n (2≤n≤200000) — количество видов конфет.</p>

  <p>Каждая из следующих n строк каждого набора входных данных содержит два целых числа ai и bi (1 ≤ ai ≤ 10⁹, 1 ≤ bi ≤ 10000) — количество конфет и стоимость одной конфеты типа i соответственно.</p>

  <p>Гарантируется, что сумма n по всем наборам входных данных не превышает 200000.</p>

  <h4>Выходные данные</h4>
  <p>Для каждого набора входных данных, выведите минимальное количество ценников необходимое для описания стоимостей всех товаров в магазине.</p>

  <h4>Пример</h4>
<pre>
5
4
20 3
6 2
14 5
20 7
3
444 5
2002 10
2020 2
5
7 7
6 5
15 2
10 3
7 7
5
10 1
11 5
5 1
2 2
8 2
6
7 12
12 3
5 3
9 12
9 3
1000000000 10000
</pre>
<pre>
2
1
3
2
5
</pre>
  <p>В первом наборе входных данных можно выбрать d1=4, d2=6, d3=7, d4=5. Тогда стоимости товаров будут равны: [12,12,35,35]. Для их описания хватит 2 ценников, первый ценник для c1,c2 и второй ценник для c3,c4. Можно показать, что при любом корректном выборе di для описания всех товаров понадобится как минимум 2 ценника. Также обратите внимание, что этот пример иллюстрируется картинкой в условии задачи.</p>
  <p>Во втором наборе входных данных при d1=4, d2=2, d3=10 стоимости всех товаров будут равны 20. Таким образом 1 ценника хватит для описания всех товаров. Обратите внимание, что ai делится на di для всех i, что является необходимым условием.</p>
  <p>В третьем наборе входных данных нетрудно понять, что для описания 2, 3 и 4 товара может быть использован один ценник. И дополнительно понадобится по ценнику для товаров 1 и 5. Итого 3 ценника.</p>
</article>


<!-- Задача D. Шокирующая расстановка -->
<article class="article">
  <div class="anchor" id="task4"></div>
  <h3>Задача D. Шокирующая расстановка</h3>

  <div><i>Ограничение по времени 2с
  <br>Ограничение по памяти 256мб</i></div>

  <p>Вам дан массив a1,a2,…,an, состоящий из целых чисел, такой что a1+a2+…+an=0.</p>

  <p>Переставьте элементы массива a таким образом, чтобы выполнялось следующее условие:</p>
  <code>max |al+al+1+…+ar| &lt; max(a1,a2,…,an)-min(a1,a2,…,an),</code>
  <p>где |x| обозначает модуль числа x.</p>

  <p>Более формально, вам нужно выяснить, существует ли такая перестановка p1,p2,…,pn, что для массива ap1,ap2,…,apn выполняется условие выше, и найти полученный массив.</p>

  <p>Напомним, что массив p1,p2,…,pn называется перестановкой, если для каждого числа x от 1 до n существует ровно одно i от 1 до n такое, что pi=x.</p>

  <h4>Входные данные</h4>
  <p>Каждый тест состоит из нескольких наборов входных данных. В первой строке находится одно целое число t (1≤t≤50000) — количество наборов входных данных. Далее следует описание наборов входных данных.</p>

  <p>Первая строка каждого набора входных данных содержит одно целое число n (1≤n≤300000) — длина массива a.</p>

  <p>Вторая строка каждого набора входных данных содержит n целых чисел a1,a2,…,an (-10⁹ ≤ ai ≤ 10⁹) — элементы массива a. Гарантируется, что сумма массива a равняется нулю, иными словами: a1+a2+…+an=0.</p>

  <p>Гарантируется, что сумма значений n по всем наборам входных данных не превосходит 300000.</p>

  <h4>Выходные данные</h4>
  <p>Для каждого набора входных данных, если переставить элементы массива a требуемым образом невозможно, в единственной строке выведите «No».</p>

  <p>Если же это возможно, в первой строке выведите «Yes», а далее в отдельной строке n чисел — элементы a1,a2,…,an, переставленные в нужном порядке (ap1,ap2,…,apn).</p>

  <p>Если возможных ответов несколько, вы можете вывести любой из них.</p>

  <h4>Пример</h4>
<pre>
7
4
3 4 -2 -5
5
2 2 2 -3 -3
8
-3 -3 1 1 1 1 1 1
3
0 1 -1
7
-3 4 3 4 -4 -4 0
1
0
7
-18 13 -18 -17 12 15 13
</pre>
<pre>
Yes
-5 -2 3 4
Yes
-3 2 -3 2 2
Yes
1 1 1 -3 1 1 1 -3
Yes
-1 0 1
Yes
4 -4 4 -4 0 3 -3
No
Yes
13 12 -18 15 -18 13 -17
</pre>
  <p>В первом наборе входных данных max(a1,…,an)-min(a1,…,an)=9. Поэтому элементы можно переставить следующим образом: [-5,-2,3,4]. Несложно видеть, что для такой расстановки значение |al+…+ar| всегда не больше 7, а значит и меньше 9.</p>
  <p>Во втором наборе входных данных можно переставить элементы массива следующим образом: [-3,2,-3,2,2]. Тогда максимальный модуль суммы будет достигаться на подмассиве [-3,2,-3], и будет равен |-3+2+-3|=|-4|=4, что меньше чем 5.</p>
  <p>В четвёртом тестовом примере любая перестановка массива a  подойдёт в качестве ответа, в том числе и [-1,0,1].</p>
</article>


<!-- Задача E. Генератор мультитестов -->
<article class="article">
  <div class="anchor" id="task5"></div>
  <h3>Задача E. Генератор мультитестов</h3>

  <div><i>Ограничение по времени 2с
  <br>Ограничение по памяти 256мб</i></div>

  <p>Массив b1,b2,…,bm назовём тестом, если b1=m-1.</p>

  <p>Массив b1,b2,…,bm назовём мультитестом, если массив b2,b3,…,bm можно разбить на b1 непустых подмассивов так, что каждый из этих подмассивов является тестом. Обратите внимание, что каждый элемент массива должен войти в ровно один подмассив из разбиения, при этом каждый подмассив должен состоять из последовательных элементов исходного массива.</p>

  <p>Определим функцию f от массива b1,b2,…,bm как минимальное количество операций вида «Заменить любое bi на любое целое неотрицательное число x», которое нужно сделать, чтобы массив b1,b2,…,bm стал мультитестом.</p>

  <p>Дан массив a1,a2,…,an из положительных чисел. Для каждого i от 1 до n-1 найдите f([ai,ai+1,…,an]).</p>

  <p>Ниже приведены некоторые примеры тестов и мультитестов.</p>
  <ul>
    <li>Тесты: [1–,5], [2–,2,2], [3–,4,1,1], [5–,0,0,0,0,0], [7–,1,2,3,4,5,6,7], [0–]. Эти массивы являются тестами, так как их первый элемент (подчеркнут) равен длине массива минус один.</li>
    <li>Мультитесты: [1,1–,1––––], [2,3–,0,0,1––––––––,1–,12–––––], [3,2–,2,7––––––,1–,1––––,3–,4,4,4––––––––], [4,0––,3–,1,7,9––––––––,4–,2,0,0,9––––––––––,1–,777––––––]. Подчеркнуты подмассивы после разбиения, а два раза подчеркнуты первые элементы в них.</li>
  </ul>

  <h4>Входные данные</h4>
  <p>Каждый тест состоит из нескольких наборов входных данных. В первой строке находится одно целое число t (1 ≤ t ≤ 300000) — количество наборов входных данных. Далее следует описание наборов входных данных.</p>

  <p>Первая строка каждого набора входных данных содержит одно целое число n (2≤n≤300000) — длина массива a.</p>

  <p>Вторая строка каждого набора входных данных содержит n целых чисел a1,a2,…,an (1≤ai≤300000) — элементы массива a.</p>

  <p>Гарантируется, что сумма значений n по всем наборам входных данных не превосходит 300000.</p>

  <h4>Выходные данные</h4>
  <p>Для каждого набора входных данных выведите n-1 число — значения f([ai,ai+1,…,an]) для каждого i от 1 до n-1.</p>

  <h4>Пример 1</h4>
<pre>
3
4
1 2 1 7
7
3 1 3 1 2 1 1
4
2 7 1 1
</pre>
<pre>
0 1 1
0 1 1 0 1 1
1 1 1
</pre>

  <h4>Пример 2</h4>
<pre>
1
19
3 4 1 2 1 7 7 3 1 3 1 2 1 1 4 2 7 1 1
</pre>
<pre>
0 0 1 1 1 1 1 1 1 0 1 0 1 0 2 1 1 1
</pre>
</article>


<!-- Задача F. Подарки от Деда Ахмеда -->
<article class="article">
  <div class="anchor" id="task6"></div>
  <h3>Задача F. Подарки от Деда Ахмеда</h3>

  <div><i>Ограничение по времени 1с
  <br>Ограничение по памяти 256мб</i></div>

  <p>В Школе Деда Ахмеда обучается n+1 ученик. Ученики разбиты на k классов, и в i-м классе обучается si учеников. Таким образом, s1+s2+…+sk=n+1.</p>

  <p>В честь скорого Дня дурака все ученики получат подарки!</p>

  <p>Дед Ахмед планировал заказать n+1 коробку с подарками. В каждой коробке будет один или несколько подарков. Дед Ахмед распределит их между классами так, чтобы были выполнены следующие условия:</p>
  <ol>
    <li>Класс номер i должен получить ровно si коробок (чтобы каждый ученик мог открыть ровно одну коробку с подарками).</li>
    <li>Суммарное количество подарков в коробках, полученных i-м классом, должно быть кратным si (то есть поровну распределяться между si учениками этого класса).</li>
  </ol>
  <p>К сожалению, Дед Ахмед по невнимательности заказал всего n коробок с подарками, в i-й из которых содержится ai подарков.</p>

  <p>У Ахмеда есть время, чтобы купить недостающую коробку с подарками, причем количество подарков в коробке должно быть целым числом от 1 до 10⁶. Помогите Ахмеду определить, коробку с каким количеством подарков ему стоит купить, а также постройте подходящее распределение коробок по классам, или сообщите, что это невозможно.</p>

  <h4>Входные данные</h4>
  <p>Первая строка содержит два целых числа n и k (1≤n, k≤200, k≤n+1).</p>

  <p>Вторая строка содержит n целых чисел a1,a2,…,an (1≤ai≤10⁶) — количество подарков в имеющихся коробках.</p>

  <p>Третья строка содержит k целых числа s1,s2,…,sk (1≤si≤n+1) — количество учеников в классах. Гарантируется, что ∑si=n+1.</p>

  <h4>Выходные данные</h4>
  <p>Если подходящего распределения не существует, в единственной строке выведите число -1.</p>

  <p>Иначе, в первой строке выведите единственное число s — количество подарков в коробке, которую должен купить Дед Ахмед (1≤s≤10⁶).</p>

  <p>Далее в k строках выведите распределение коробок по классам. В i-й строке выведите si целых чисел — размеры коробок, которые попадут в i-й класс.</p>

  <p>Если существует несколько решений, выведите любое из них.</p>

  <h4>Пример 1</h4>
<pre>
4 2
7 7 7 127
2 3
</pre>
<pre>
1
7 7
7 127 1
</pre>

  <h4>Пример 2</h4>
<pre>
18 4
1 2 3 4 5 6 7 8 9 1 2 3 4 5 6 7 8 9
6 1 9 3
</pre>
<pre>
9
7 1 7 6 5 4
9
1 2 3 8 3 2 9 8 9
6 5 4
</pre>
  <p>В первом тестовом примере Дед Ахмед может купить всего 1  подарок. После определить в первый класс две коробки с 7  подарками. 7+7=14 нацело делится на 2. А во второй класс достанутся коробки с 1,7,127 подарками. 1+7+127=135 нацело делится на 3.</p>
  <p>Во втором тестовом примере классы имеют размеры 6, 1, 9 и 3. Покажем, что имеющихся коробок достаточно, чтобы распределить в классы размеров 6, 9, 3, а в класс размера 1 можно купить коробку любого размера. В класс размера 6 отправим коробки размеров 7, 1, 7, 6, 5, 4. 7+1+7+6+5+4=30 нацело делится на 6. В класс размера 9 отправим коробки размеров 1, 2, 3, 8, 3, 2, 9, 8, 9. 1+2+3+8+3+2+9+8+9=45 нацело делится на 9. В класс размера 3 отправятся оставшиеся коробки размеров 6, 5, 4. 6+5+4=15 нацело делится на 3.</p>
</article>
