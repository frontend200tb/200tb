<article class="article">
  <a href="https://codeforces.com/contest/2091" target="_blank">Codeforces 2091 Round 1013 (Div.3) 2025-03-25</a>
</article>


<!-- Содержание -->
<article class="article">
  <h2>Содержание</h2>

      <a href="#task1">Задача A. Дата олимпиады</a>
  <br><a href="#task2">Задача B. Командная тренировка</a>
  <br><a href="#task3">Задача C. Кодовый замок</a>
  <br><a href="#task4">Задача D. Место олимпиады</a>
  <br><a href="#task5">Задача E. Интересное соотношение</a>
  <br><a href="#task6">Задача F. Игорь и гора</a>
  <br><a href="#task7">Задача G. Глеб и гребля</a>
</article>


<!-- Задача A. Дата олимпиады -->
<article class="article">
  <div class="anchor" id="task1"></div>
  <h3>Задача A. Дата олимпиады</h3>

  <div><i>Ограничение по времени 1с
  <br>Ограничение по памяти 256мб</i></div>

  <p>Финал первой олимпиады ИТ-кампуса «НЕЙМАРК» проходит 1 марта 2025 года. Безымянному стажёру было поручено составить из цифр дату проведения олимпиады — 01.03.2025.</p>

  <p>Для этого стажёр взял большой мешок с цифрами и начал вытаскивать их по одной, всего он вытащил n цифр, цифра aᵢ была вытащена i-й по порядку.</p>

  <p>Вы подозреваете, что стажёр выполнил лишнюю работу. Определите, на каком шаге стажёр впервые мог собрать из цифр дату проведения олимпиады (разделяющими точками можно пренебречь) или сообщите, что из вытащенных стажёром цифр собрать эту дату невозможно. Обратите внимание, что ведущие нули нужно отображать.</p>

  <h4>Входные данные</h4>
  <p>Первая строка содержит целое число t (1 ≤ t ≤ 10⁴) — количество наборов входных данных.</p>

  <p>Первая строка каждого набора входных данных содержит одно целое число n (1 ≤ n ≤ 20) — количество цифр.</p>

  <p>Следующая строка содержит n значений aᵢ (0 ≤ aᵢ ≤ 9) — цифры, которые вытаскивал стажёр в хронологическом порядке.</p>

  <h4>Выходные данные</h4>
  <p>Для каждого набора входных данных выведите одно число — минимальное количество цифр, которое достаточно было вытащить стажёру. Если из всех цифр составить дату не получится, выведите число 0.</p>

  <details>
    <summary>Пример</summary>
<pre>
4
10
2 0 1 2 3 2 5 0 0 1
8
2 0 1 2 3 2 5 0
8
2 0 1 0 3 2 5 0
16
2 3 1 2 3 0 1 9 2 1 0 3 5 4 0 3
</pre>
<pre>
9
0
8
15
</pre>
  </details>
</article>


<!-- Задача B. Командная тренировка -->
<article class="article">
  <div class="anchor" id="task2"></div>
  <h3>Задача B. Командная тренировка</h3>

  <div><i>Ограничение по времени 2с
  <br>Ограничение по памяти 256мб</i></div>

  <p>В ИТ-кампусе «НЕЙМАРК» проходят тренировки по олимпиадному программированию — личные и командные!</p>

  <p>На следующую командную тренировку придут n учеников, мастерство i-го ученика равняется целому положительному числу aᵢ.</p>

  <p>Тренер считает команду сильной, если сила команды не меньше x. Сила команды вычисляется как количество участников команды, помноженное на наименьшее мастерство отдельного участника команды.</p>

  <p>Например, если в команде 4 участника, мастерство которых [5,3,6,8], то ее сила равняется 4⋅min([5,3,6,8])=12.</p>

  <p>Выведите наибольшее возможное количество сильных команд, если в каждой команде должен быть хотя бы один участник и каждый участник должен быть ровно в одной команде.</p>

  <h4>Входные данные</h4>
  <p>Первая строка содержит целое число t (1 ≤ t ≤ 10⁴) — количество наборов входных данных.</p>

  <p>Первая строка каждого набора входных данных содержит два целых числа n, x (1 ≤ n ≤ 2⋅10⁵, 1 ≤ x ≤ 10⁹) — количество учеников на тренировке и значение минимальной силы команды, чтобы она считалась сильной.</p>

  <p>В следующей строке задано n целых чисел aᵢ (1 ≤ aᵢ ≤ 10⁹) — мастерство каждого ученика.</p>

  <p>Гарантируется, что сумма n по всем наборам входных данных не превышает 2⋅10⁵.</p>

  <h4>Выходные данные</h4>
  <p>Для каждого набора входных данных выведите наибольшее возможное количество команд силы хотя бы x.</p>

  <details>
    <summary>Пример</summary>
<pre>
5
6 4
4 5 3 3 2 6
4 10
4 2 1 3
5 3
5 3 2 3 2
3 6
9 1 7
6 10
6 1 3 6 3 2
</pre>
<pre>
4
0
4
2
1
</pre>
  </details>
</article>


<!-- Задача C. Кодовый замок -->
<article class="article">
  <div class="anchor" id="task3"></div>
  <h3>Задача C. Кодовый замок</h3>

  <div><i>Ограничение по времени 2с
  <br>Ограничение по памяти 256мб</i></div>

  <p>В ИТ-кампусе «НЕЙМАРК» есть несколько совершенно секретных помещений, в которых ведется разработка задач к значимым олимпиадам по программированию. Чтобы попасть в такое помещение, нужно открыть круглый замок, подобрав верный код. Каждый день этот код обновляется.</p>

  <p>Сегодня кодом является перестановка∗ из чисел от 1 до n, в каждом циклическом сдвиге† которой есть ровно одна неподвижная точка. То есть в каждом сдвиге существует число, значение которого совпадает с позицией в перестановке. Для лучшего понимания смотрите примечание к тестовым примерам.</p>

  <p>Выведите любую подходящую перестановку. Имейте в виду, что подходящей перестановки может не существовать, а значит, сегодня помещение не работает, в таком случае выведите -1.</p>

  <p>* Перестановкой будем называть последовательность длины n
   целых чисел от 1 до n, в которой все числа встречаются по одному разу. Например, (2 1 3), (1), (4 3 1 2) - перестановки, (1 2 2), (3), (1 3 2 5) - нет.</p>

  <p>† Циклический сдвиг массива получается перемещением последнего элемента в начало массива. У перестановки длины n есть ровно n циклических сдвигов.</p>

  <h4>Входные данные</h4>
  <p>Первая строка содержит целое число t (1 ≤ t ≤ 500) — количество наборов входных данных.</p>

  <p>Единственная строка каждого набора входных данных содержит одно целое число n (1 ≤ n ≤ 2⋅10⁵).</p>

  <p>Гарантируется, что сумма n по всем наборам входных данных не превышает 2⋅10⁵.</p>

  <h4>Выходные данные</h4>
  <p>Для каждого набора входных данных выведите искомую перестановку. Если существует несколько решений, выведите любое из них. Если подходящих перестановок не существует, выведите -1.</p>

  <details>
    <summary>Пример</summary>
<pre>
3
4
5
3
</pre>
<pre>
-1
4 1 3 5 2
1 3 2
</pre>
  <p>Во втором примере существует перестановка, в каждом циклическом сдвиге которой есть неподвижная точка (выделено темно-красным):</p>
<pre>
1 2 3 4 5
4 1 3 5 2
</pre>
<pre>
1 2 3 4 5
2 4 1 3 5
</pre>
<pre>
1 2 3 4 5
5 2 4 1 3
</pre>
<pre>
1 2 3 4 5
3 5 2 4 1
</pre>
<pre>
1 2 3 4 5
1 3 5 2 4
</pre>

  <p>Первая строка содержит номера элементов, а вторая — все сдвиги искомой перестановки.</p>
  </details>
</article>


<!-- Задача D. Место олимпиады -->
<article class="article">
  <div class="anchor" id="task4"></div>
  <h3>Задача D. Место олимпиады</h3>

  <div><i>Ограничение по времени 1с
  <br>Ограничение по памяти 256мб</i></div>

  <p>Для проведения финала первой олимпиады ИТ-кампуса «НЕЙМАРК» была подготовлена прямоугольная площадка. Можно считать, что площадка разделена на n рядов, в каждом из которых есть m мест для столов участников. Всего на финал зарегистрировалось k участников, каждый из которых будет сидеть за отдельным столом, и теперь оргкомитету олимпиады предстоит выбрать места для столов на площадке.</p>

  <p>Каждый стол занимает одно из m мест в ряду. При этом, если несколько столов занимают подряд идущие места в одном ряду, то такую группу столов будем называть партой, а количество столов в группе — длиной парты. Например, рассадить 7 участников на площадке размерами 3x4 (n=3,m=4) можно следующим образом:</p>

<pre>
###
 ##
 # #
</pre>

  <p>На рисунке выше в первом ряду находится одна парта длины 3, во втором — одна парта длины 2, а в третьем — две парты длины 1.</p>

  <p>Оргкомитет хочет выбрать места так, чтобы длина самой длинной парты была как можно меньше. В частности, эти же 7 столов можно расставить более оптимальным образом, чтобы длины всех парт не превосходили 2:</p>

<pre>
## #
 ##
 # #
</pre>

  <p>Зная числа n, m и k, найдите минимальную возможную длину самой длинной парты.</p>

  <h4>Входные данные</h4>
  <p>Первая строка содержит целое число t (1 ≤ t ≤ 10⁴) — количество наборов входных данных.</p>

  <p>Единственная строка каждого набора входных данных содержит три натуральных числа — n, m и k (1 ≤ n, m, k ≤ 10⁹, k ≤ n⋅m).</p>

  <h4>Выходные данные</h4>
  <p>Для каждого набора входных данных выведите одно число — минимальную возможную длину.</p>

  <details>
    <summary>Пример</summary>
<pre>
5
3 4 7
5 5 5
1 13 2
2 4 7
1 5 4
</pre>
<pre>
2
1
1
4
2
</pre>
  </details>
</article>


<!-- Задача E. Интересное соотношение -->
<article class="article">
  <div class="anchor" id="task5"></div>
  <h3>Задача E. Интересное соотношение</h3>

  <div><i>Ограничение по времени 2с
  <br>Ограничение по памяти 256мб</i></div>

  <p>Совсем недавно Миша на сборах от ИТ-кампуса «НЕЙМАРК» изучил новую для себя тему — алгоритм Евклида.</p>

  <p>Он был немного удивлен, когда понял, что a⋅b=lcm(a,b)⋅gcd(a,b), где gcd(a,b) — наибольший общий делитель (НОД) чисел a и b, а lcm(a,b) — наименьшее общее кратное (НОК). Миша подумал, что если есть произведение НОК и НОД, то будет не лишним рассмотреть и частное — F(a,b) = lcm(a,b) / gcd(a,b).</p>

  <p>Для примера он взял a=2 и b=4, посчитал F(2,4) = 4 / 2 = 2 и получил простое число (число простое, если у него ровно 2 делителя)! Теперь он считает F(a,b) интересным соотношением, если a &lt; b и F(a,b) — простое число.</p>

  <p>Поскольку Миша только недавно начал изучать теорию чисел, то ему нужна ваша помощь, чтобы посчитать — а сколько существует различных пар чисел a и b таких, что F(a,b) — интересное соотношение и 1 ≤ a &lt; b ≤ n.</p>

  <h4>Входные данные</h4>
  <p>Первая строка содержит целое число t (1 ≤ t ≤ 10³) — количество наборов входных данных.</p>

  <p>Единственная строка каждого набора входных данных содержит одно целое число n (2 ≤ n ≤ 10⁷).</p>

  <p>Гарантируется, что сумма n по всем наборам входных данных не превышает 10⁷.</p>

  <h4>Выходные данные</h4>
  <p>Для каждого набора входных данных выведите количество интересных соотношений F(a,b), где 1 ≤ a &lt; b ≤ n;</p>

  <details>
    <summary>Пример</summary>
<pre>
4
5
10
34
10007
</pre>
<pre>
4
11
49
24317
</pre>
  </details>
</article>


<!-- Задача F. Игорь и гора -->
<article class="article">
  <div class="anchor" id="task6"></div>
  <h3>Задача F. Игорь и гора</h3>

  <div><i>Ограничение по времени 5с
  <br>Ограничение по памяти 512мб</i></div>

  <p>Посетители ИТ-кампуса «НЕЙМАРК» не только сильные программисты, но и физически крепкие люди! Кто-то занимается плаванием, кто-то — греблей, а кто-то — скалолазанием!</p>

  <p>Мастер Игорь — опора скалолазного движения в регионе. Однажды он пошел в поход в горы, чтобы подняться на вершину одной из них. Как опытный скалолаз, Игорь решил не подниматься в гору по тропинкам, а использовать свои навыки, чтобы подняться в гору строго вертикально.</p>

  <p>Игорь нашел прямоугольную вертикальную часть горы и мысленно разбил её на n горизонтальных уровней. Каждый из уровней Игорь мысленно разбил вертикальными перегородками на m участков. Осмотрев эти участки, Игорь нашел удобные выступы, за которые можно держаться руками (далее будем называть их зацепки). Итого, найденную часть горы можно представить в виде прямоугольника n x m, в некоторых клетках которого расположены зацепки.</p>

  <p>Как опытный программист, Игорь решил посчитать, сколько существует правильных трасс. Трасса — это последовательность различных участков с зацепками. Трасса считается правильной, если выполняются следующие условия:</p>
  <ul>
    <li>первая зацепка трассы находится на самом нижнем уровне (строка n);</li>
    <li>последняя зацепка трассы находится на самом верхнем уровне (строка 1);</li>
    <li>каждая следующая зацепка находится не ниже предыдущей;</li>
    <li>на каждом уровне (то есть на каждой строке прямоугольника) используется хотя бы одна зацепка;</li>
    <li>на каждом уровне используются максимум две зацепки (у Игоря всего две руки);</li>
    <li>Игорь может дотянуться от текущей зацепки до следующей, если расстояние между центрами соответствующих участков не превосходит размаха рук Игоря.</li>
  </ul>
  <p>Размах рук Игоря равен d, то есть он может перейти с одной зацепки на другую, если Евклидово расстояние между центрами соответствующих участков не превосходит d. Расстояние между участками (i1,j1) и (i2,j2) равняется √(i1-i2)²+(j1-j2)².</p>

  <p>Посчитайте, сколько существует различных правильных трасс. Две трассы считаются различными, если они отличаются списком используемых участков или порядком следования этих участков.</p>

  <h4>Входные данные</h4>
  <p>Первая строка содержит целое число t (1 ≤ t ≤ 10³) — количество наборов входных данных.</p>

  <p>В первой строке каждого набора входных данных содержится три натуральных числа — n, m и d (2 ≤ n ≤ 2000, 1 ≤ m, d ≤ 2000).</p>

  <p>Каждая из следующих n строк содержит m символов — описание очередного уровня горы. Символ '#' соответствует пустому участку, а символ 'X' — участку с зацепкой. Уровни описываются сверху-вниз.</p>

  <p>Гарантируется, что сумма n⋅m по всем наборам входных данных не превышает 4⋅10⁶.</p>

  <h4>Выходные данные</h4>
  <p>Для каждого набора входных данных выведите одно число — количество различных трасс. Поскольку это число может быть очень большим, выведите его остаток от деления на 998244353.</p>

  <details>
    <summary>Пример</summary>
<pre>
3
3 4 1
XX#X
#XX#
#X#X
3 4 2
XX#X
#XX#
#X#X
3 1 3
X
X
#
</pre>
<pre>
2
60
0
</pre>
  <p>Возможные трассы в первом примере:</p>
  <p>Во втором примере размах рук Игоря стал больше, поэтому ему доступны новые трассы, например, такая:</p>
  <p>В третьем примере на нижнем уровне нет зацепок, поэтому правильных трасс не существует.</p>
  </details>
</article>


<!-- Задача G. Глеб и гребля -->
<article class="article">
  <div class="anchor" id="task7"></div>
  <h3>Задача G. Глеб и гребля</h3>

  <div><i>Ограничение по времени 3с
  <br>Ограничение по памяти 256мб</i></div>

  <p>Программист Глеб часто посещает ИТ-кампус «НЕЙМАРК» для участия в тренировках по программированию.</p>

  <p>Глеб не только программист, но и известный гребец, поэтому часть пути от дома до кампуса он преодолевает по реке на байдарке. Можно считать, что Глеб стартует в точке 0 и должен приплыть в точку s, то есть проплыть s метров вдоль прямой. Чтобы усложнить себе задачу, Глеб решил не выплывать за пределы отрезка [0,s]. Размерами байдарки можно пренебречь.</p>

  <p>Глеб — сильный программист! Изначально его сила равняется k. Сила Глеба напрямую влияет на движение его байдарки. Если текущая сила равна x, то за один взмах весла Глеба байдарка перемещается на x метров в текущем направлении. Глеб может разворачиваться, после чего продолжить движение в противоположном направлении, однако такой маневр довольно сложен, и после каждого разворота сила Глеба уменьшается на 1. Сила не может стать равной 0 — если текущая сила равнялась 1, то и после разворота она останется 1. Кроме того, Глеб не может делать два разворота подряд — после каждого разворота он должен переместиться хотя бы один раз, прежде чем делать еще один разворот. Аналогично, Глеб не может сделать разворот сразу после старта — сначала он должен взмахнуть веслом.</p>

  <p>Глеб хочет попасть из точки 0 в точку s, не заплывать за границы этого отрезка [0,s], но при этом сохранить как можно больше сил. Помогите ему — зная величину s и начальное значение силы Глеба k, определите, какое наибольшее значение может иметь его сила при попадании в точку s.</p>

  <h4>Входные данные</h4>
  <p>Первая строка содержит целое число t (1 ≤ t ≤ 100) — количество наборов входных данных.</p>

  <p>Единственная строка каждого набора входных данных содержит два натуральных числа — s и k (1 ≤ s ≤ 10⁹, 1 ≤ k ≤ 1000, k ≤ s).</p>

  <p>Гарантируется, что сумма k по всем наборам входных данных не превышает 2000.</p>

  <h4>Выходные данные</h4>
  <p>Для каждого набора входных данных выведите одно число — максимально возможную силу Глеба в конце пути.</p>

  <details>
    <summary>Пример</summary>
<pre>
8
9 6
10 7
24 2
123456 777
6 4
99 6
10 4
99 4
</pre>
<pre>
4
1
2
775
1
4
2
2
</pre>
  <p>Один из вариантов движения Глеба в первом примере:</p>
  </details>
</article>

