<article class="article">
  <a href="https://codeforces.com/contest/230" target="_blank">Codeforces Round 142 (Div. 2) 2012-10-01</a>
</article>


<!-- Содержание -->
<article class="article">
  <h2>Содержание</h2>

      <a href="#task1">Задача A. Драконы</a>
  <br><a href="#task2">Задача B. Т-простые числа</a>
  <br><a href="#task3">Задача C. Сдвиги</a>
  <br><a href="#task4">Задача D. Планеты</a>
  <br><a href="#task5">Задача E. Треугольники</a>
</article>


<!-- Задача A. Драконы -->
<article class="article">
  <div class="anchor" id="task1"></div>
  <h3>Задача A. Драконы</h3>

  <div><i>Ограничение по времени 2с
  <br>Ограничение по памяти 256мб</i></div>

  <p>Кирито застрял на очередном уровне MMORPG, в которую он играет. Чтобы пройти игру дальше, ему нужно победить всех n драконов, которые живут на этом уровне. Как Кирито, так и драконы обладают силой, которая выражается целым числом. В схватке между двумя противниками исход схватки определяется их силой. Изначально сила Кирито равна s.</p>

  <p>Если Кирито вступает в схватку с i-ым (1 ≤ i ≤ n) драконом и его сила не больше, чем сила этого дракона xi, то Кирито проигрывает схватку и умирает. Если же сила Кирито больше, чем сила дракона, то он побеждает дракона и получает бонус — его сила увеличивается на yi.</p>

  <p>Кирито может сражаться с драконами в произвольном порядке. Определите, сможет ли он пройти на следующий уровень игры, то есть победить всех драконов, не умирая ни разу.</p>

  <h4>Входные данные</h4>
  <p>Первая строка содержит два целых числа s и n (1 ≤ s ≤ 10⁴, 1 ≤ n ≤ 10³), разделенные пробелом. Далее следуют n строк: i-ая строка содержит целые числа xi и yi (1 ≤ xi ≤ 10⁴, 0 ≤ yi ≤ 10⁴), разделенные пробелом — силу i-го дракона и бонус за победу над ним.</p>

  <h4>Выходные данные</h4>
  <p>В единственной строке выведите «YES» (без кавычек), если Кирито сможет пройти на следующий уровень, и «NO» (без кавычек), если не сможет.</p>

  <h4>Пример 1</h4>
<pre>
2 2
1 99
100 0
</pre>
  <code>YES</code>

  <h4>Пример 2</h4>
<pre>
10 1
100 100
</pre>
  <code>NO</code>
  <p>В первом примере сила Кирито изначально равна 2. Поскольку сила первого дракона меньше 2, то Кирито может с ним сразиться и победить его. После этого он получает бонус и его сила возрастает до 2 + 99 = 101. Теперь он может победить второго дракона и пройти на следующий уровень.</p>
  <p>Во втором примере сила Кирито слишком мала, чтобы он мог сразиться с единственным драконом и победить.</p>
</article>


<!-- Задача B. Т-простые числа -->
<article class="article">
  <div class="anchor" id="task2"></div>
  <h3>Задача B. Т-простые числа</h3>

  <div><i>Ограничение по времени 2с
  <br>Ограничение по памяти 256мб</i></div>

  <p>Известно, что простыми называются целые положительные числа, у которых ровно два различных положительных делителя. По аналогии назовем целое положительное число t Т-простым, если у t ровно три различных положительных делителя.</p>

  <p>Вам дан массив, состоящий из n целых положительных чисел. Для каждого из них определите, является ли оно Т-простым или нет.</p>

  <h4>Входные данные</h4>
  <p>Первая строка содержит единственное целое число — количество чисел в массиве, n (1 ≤ n ≤ 10⁵). Следующая строка содержит n целых чисел xᵢ (1 ≤ xᵢ ≤ 10¹²), разделенных пробелами.</p>

  <p>Пожалуйста, не используйте спецификатор %lld для чтения или записи 64-битных чисел на С++. Рекомендуется использовать потоки cin, cout или спецификатор %I64d.</p>

  <h4>Выходные данные</h4>
  <p>Выведите n строк: i-тая строка должна содержать «YES» (без кавычек), если число xi является Т-простым, и «NO» (без кавычек), если не является.</p>

  <h4>Пример</h4>
<pre>
3
4 5 6
</pre>
<pre>
YES
NO
NO
</pre>
  <p>В приведенном тесте даны три числа. Первое число 4 имеет ровно три делителя — 1, 2 и 4, поэтому ответ для этого числа — «YES». Второе число 5 имеет два делителя (1 и 5), а третье число 6 — четыре делителя (1, 2, 3, 6), поэтому ответ для них — «NO».</p>
</article>


<!-- Задача C. Сдвиги -->
<article class="article">
  <div class="anchor" id="task3"></div>
  <h3>Задача C. Сдвиги</h3>

  <div><i>Ограничение по времени 2с
  <br>Ограничение по памяти 256мб</i></div>

  <p>Вам дана таблица размером n строк на m столбцов. В каждой ячейке таблицы записано число 0 или 1. За один ход можно выбрать какую-то из строк таблицы и циклически сдвинуть значения в ней на одну ячейку либо влево, либо вправо.</p>

  <p>Циклически сдвинуть строку таблицы на одну ячейку вправо означает переместить значение каждой ячейки этой строки, кроме последней, в соседнюю ячейку справа, а значение последней ячейки переместить в первую ячейку. Аналогичным образом, но в обратную сторону выполняется циклический сдвиг строки таблицы влево. Например, если циклически сдвинуть строку «00110» на одну ячейку вправо — получится строка «00011», если же сдвинуть строку «00110» на одну ячейку влево — получится строка «01100».</p>

  <p>Определите, за какое наименьшее количество ходов можно добиться того, что в каком-то из столбцов таблицы будут только единицы.</p>

  <h4>Входные данные</h4>
  <p>Первая строка содержит два целых числа, разделенные пробелом: n (1 ≤ n ≤ 100) — количество строк в таблице и m (1 ≤ m ≤ 10⁴) — количество столбцов в таблице. Далее следуют n строк, каждая из которых содержит по m символов «0» или «1»: j-тый символ i-той строки описывает содержимое ячейки в i-той строке и j-ом столбце таблицы.</p>

  <p>Гарантируется, что в описании таблицы не встречается никаких символов кроме «0» и «1».</p>

  <h4>Выходные данные</h4>
  <p>Выведите единственное число: наименьшее количество ходов, за которое можно в каком-то из столбцов таблицы получить только единицы. Если этого сделать нельзя, выведите -1.</p>

  <h4>Пример 1</h4>
<pre>
3 6
101010
000100
100000
</pre>
  <code>3</code>

  <h4>Пример 2</h4>
<pre>
2 3
111
000
</pre>
  <code>-1</code>
  <p>В первом примере один из способов достижения цели с наименьшим количеством шагов таков: циклически сдвинем вторую строку один раз вправо, а третью — два раза влево. Тогда предпоследний столбец таблицы будет содержать только единицы.</p>
  <p>Во втором примере строки нельзя сдвинуть так, чтобы образовался столбец, содержащий только единицы.</p>
</article>


<!-- Задача D. Планеты -->
<article class="article">
  <div class="anchor" id="task4"></div>
  <h3>Задача D. Планеты</h3>

  <div><i>Ограничение по времени 2с
  <br>Ограничение по памяти 256мб</i></div>

  <p>Гоа'улд Апофис снова захватил команду Джека О'Нила! Сам Джек смог спастись, но к тому времени корабль Апофиса уже совершил прыжок в гиперпространство. Однако Джек знает, на какой планете высадится Апофис. Чтобы спасти друзей, Джеку предстоит несколько раз пройти через звездные врата, чтобы попасть на эту планету.</p>

  <p>Всего в галактике находится n планет, пронумерованных числами от 1 до n. Джек находится на планете с номером 1, а Апофис высадится на планете с номером n. Между некоторыми парами планет можно перемещаться через звездные врата (перемещение возможно в обоих направлениях); перемещение занимает положительное и, возможно, для разных пар планет неодинаковое количество секунд. Джек начинает свое путешествие в момент времени 0.</p>

  <p>Может оказаться, что на планету, где сейчас находится Джек, через звездные врата прибывают другие путешественники, в этом случае Джек должен подождать ровно 1 секунду, прежде чем сам сможет воспользоваться звездными вратами. То есть, если в момент времени t на планету прибывает другой путешественник, то Джек может пройти через врата только в момент времени t + 1, если только в момент времени t + 1 на ту же планету не прибывают еще путешественники.</p>

  <p>Зная информацию о времени перемещения между планетами, а также о моментах времени, когда Джек не сможет пользоваться звездными вратами на конкретных планетах, определите наименьшее время, за которое он сможет попасть на планету с номером n.</p>

  <h4>Входные данные</h4>
  <p>Первая строка содержит два целых числа, разделенные пробелом: n (2 ≤ n ≤ 10⁵), количество планет в галактике, и m (0 ≤ m ≤ 10⁵), количество пар планет, между которыми можно перемещаться сквозь звездные врата. Далее следуют m строк, в каждой из них содержится три целых числа: i-ая строка содержит номера планет aᵢ и bᵢ (1 ≤ aᵢ, bᵢ ≤ n, aᵢ ≠ bᵢ), между которыми есть связь через звездные врата, и целочисленное время (в секундах) перемещения между этими планетами cᵢ (1 ≤ cᵢ ≤ 10⁴). Гарантируется, что между любой парой планет существует не более одного перехода, образованного звездными вратами.</p>

  <p>Далее следуют n строк: i-тая строка содержит целое число kᵢ (0 ≤ kᵢ ≤ 10⁵), которое обозначает количество моментов времени, в которые на планету с номером i прибывают другие путешественники. Далее через пробел следуют kᵢ упорядоченных по возрастанию различных целых чисел t<sub>ij</sub> (0 ≤ t<sub>ij</sub> &lt; 10⁹). Число t<sub>ij</sub> обозначает, что в момент времени t<sub>ij</sub> (в секундах) на планету i прибывает другой путешественник. Гарантируется, что сумма всех kᵢ не превышает 10⁵.</p>

  <h4>Выходные данные</h4>
  <p>Выведите единственное число — наименьшее количество времени, которое понадобится Джеку, чтобы попасть с планеты 1 на планету n. Если Джек не сможет попасть на планету n ни за какое время, выведите число -1.</p>

  <h4>Пример 1</h4>
<pre>
4 6
1 2 2
1 3 3
1 4 8
2 3 4
2 4 5
3 4 3
0
1 3
2 3 4
0
</pre>
  <code>7</code>

  <h4>Пример 2</h4>
<pre>
3 1
1 2 3
0
1 3
0
</pre>
  <code>-1</code>
  <p>В первом примере у Джека три выбора, куда переместиться с планеты 1. Если он переместится сразу на планету 4, то потратит 8 секунд. Если он переместится на планету 3, то потратит 3 секунды, но, поскольку в моменты времени 3 и 4 на планету 3 прибывают другие путешественники, то он сможет отправиться на планету 4 только в момент времени 5, затратив в сумме 8 секунд. Если же Джек переместится на планету 2, а потом на планету 4, то потратит в сумме всего лишь 2 + 5 = 7 секунд.</p>
  <p>Во втором примере с планеты 1 на планету 3 нельзя попасть, перемещаясь через звездные врата.</p>
</article>


<!-- Задача E. Треугольники -->
<article class="article">
  <div class="anchor" id="task5"></div>
  <h3>Задача E. Треугольники</h3>

  <div><i>Ограничение по времени 2с
  <br>Ограничение по памяти 256мб</i></div>

  <p>Алиса и Боб больше не играют ни в какие игры; теперь они дружно изучают свойства различных графов. Алиса придумала следующее занятие: из полного неориентированного графа с n вершинами она выбирает какие-то m ребер и оставляет их себе. Оставшиеся же n(n-1)/2 - m ребер достаются Бобу.</p>

  <p>Алисе и Бобу очень нравятся «треугольники» в графах, то есть циклы длины 3. Поэтому они хотят узнать ответ на такой вопрос: какое суммарное количество треугольников находится в двух графах, образованных ребрами Алисы и ребрами Боба, соответственно?</p>

  <h4>Входные данные</h4>
  <p>Первая строка содержит два целых числа n и m (1 ≤ n ≤ 10⁶, 0 ≤ m ≤ 10⁶), разделенные пробелом — количество вершин в изначальном полном графе, а также количество ребер в графе Алисы, соответственно. Далее следуют m строк: i-тая строка содержит два целых числа aᵢ, bᵢ (1 ≤ aᵢ, bᵢ ≤ n, aᵢ ≠ bᵢ), разделенные пробелом — номера двух вершин, соединенных i-тым ребром графа Алисы. Гарантируется, что граф Алисы не содержит кратных ребер и петель. Изначальный полный граф также не содержит кратных ребер и петель.</p>

  <p>Считайте, что вершины графа пронумерованы некоторым образом от 1 до n.</p>

  <h4>Выходные данные</h4>
  <p>Выведите единственное число — суммарное количество циклов длины 3 в графах Алисы и Боба.</p>

  <p>Пожалуйста, не используйте спецификатор %lld для чтения или записи 64-битных чисел на С++. Рекомендуется использовать потоки cin, cout или спецификатор %I64d.</p>

  <h4>Пример 1</h4>
<pre>
5 5
1 2
1 3
2 3
2 4
3 4
</pre>
  <code>3</code>

  <h4>Пример 2</h4>
<pre>
5 3
1 2
2 3
1 3
</pre>
  <code>4</code>
  <p>В первом примере в графе Алисы есть 2 треугольника: (1, 2, 3) и (2, 3, 4). В графе Боба всего 1 треугольник: (1, 4, 5). Поэтому в двух графах всего 3 треугольника.</p>
  <p>Во втором примере в графе Алисы всего 1 треугольник: (1, 2, 3). В графе Боба находится 3 треугольника: (1, 4, 5), (2, 4, 5) и (3, 4, 5). В данном случае ответ на задачу — 4.</p>
</article>

