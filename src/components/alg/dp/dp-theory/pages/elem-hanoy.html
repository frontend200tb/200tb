<h1>Ханойская башня</h1>


<!-- Содержание -->
<article class="article">
  <h2>Содержание</h2>

  <p><a href="#han">Ханойская башня</a></p>
  <p><a href="#han0">0 дисков</a></p>
  <p><a href="#han1">1 диск</a></p>
  <p><a href="#han2">2 диска</a></p>
  <p><a href="#han3">3 диска</a></p>
  <p><a href="#han4">4 диска</a></p>
  <p><a href="#hann">n дисков</a></p>
  <p><a href="#hanr">Рекуррентное соотношение</a></p>
  <p><a href="#hanz">Замкнутое выражение</a></p>
  <p><a href="#hanh">Как решать задачи с рекуррентностями</a></p>
</article>


<!-- Ханойская башня -->
<article class="article">
  <div class="anchor" id="han"></div>
  <h2>Ханойская башня</h2>

  <p>Ханойская башня - головоломка родом из XIX века. Это несколько дисков, нанизанных в порядке уменьшения размеров на один из трех колышков. Пронумеруем диски, начиная от самого маленького (верхнего).</p>
<pre>
      |                 |                 |
     *1*                |                 |
    **2**               |                 |
   ***3***              |                 |
  ****4****             |                 |
 *****5*****            |                 |
-------------     -------------     -------------
</pre>
  <p>Почти как детская пирамидка с кольцами.</p>

  <h4>Задача</h4>
  <p>Определить <strong>минимальное</strong> количество шагов для перемещения башни на свободный колышек.</p>

  <h4>Правила</h4>
  <ol>
    <li>За один ход можно перенести только один диск</li>
    <li>Нельзя класть больший диск на меньший</li>
  </ol>

  <p>Посчитаем число шагов для небольшого количества дисков, чтобы определить закономерность. Будем записывать ответы в виде последовательности чисел</p>
  <code>T<sub>0</sub>, T<sub>1</sub>, T<sub>2</sub>, ... , T<sub>n-1</sub>, T<sub>n</sub></code>
  <p>T<sub>0</sub> - минимальное количество шагов при 0 дисков</p>
  <p>T<sub>1</sub> - минимальное количество шагов при 1 диске</p>
  <p>T<sub>2</sub> - минимальное количество шагов при 2 дисках</p>
  <p>T<sub>n-1</sub> - минимальное количество шагов при n-1 дисках</p>
  <p>T<sub>n</sub> - минимальное количество шагов при n дисках</p>
</article>


<!-- 0 дисков -->
<article class="article">
  <div class="anchor" id="han0"></div>
  <h3>0 дисков</h3>

  <p>Отдельный крайний случай - когда нет дисков. Для перемещения башни без дисков вообще ни одного шага делать не нужно</p>
  <code>n = 0</code>
  <code>T<sub>0</sub> = 0</code>
</article>


<!-- 1 диск -->
<article class="article">
  <div class="anchor" id="han1"></div>
  <h3>1 диск</h3>

<pre>
  |      |      |
 *1*     |      |
-----  -----  -----
</pre>
  <p>Начнем с маленькой пирамиды в один диск высотой. Чтобы его переместить потребуется 1 шаг - взять диск и положить его на другой колышек</p>

  <h4>1-й шаг</h4>
<pre>
  |      |      |
  |     *1*     |
-----  -----  -----
</pre>
  <p>Для случая с одним диском n = 1, требуется 1 шаг</p>
  <code>n = 1</code>
  <code>T<sub>1</sub> = 1</code>
</article>


<!-- 2 диска -->
<article class="article">
  <div class="anchor" id="han2"></div>
  <h3>2 диска</h3>

<pre>
   |        |        |
  *1*       |        |
 **2**      |        |
-------  -------  -------
</pre>
  <p>Попробуем теперь переместить два диска</p>

  <h4>1-й шаг</h4>
<pre>
   |        |         |
   |        |         |
 **2**     *1*        |
-------  --------  -------
</pre>

<h4>2-й шаг</h4>
<pre>
   |        |        |
   |        |        |
   |       *1*     **2**
-------  -------  -------
</pre>

<h4>3-й шаг</h4>
<pre>
   |        |        |
   |        |       *1*
   |        |      **2**
-------  -------  -------
</pre>
  <p>Для перемещения двух дисков, мы сначала перенесли один диск. То есть на первом шаге мы решили задачу для предыдущего случая с перемещением одного диска. Значит и число шагов для предыдущего случая уже известно - 1 шаг. Потом перенесли второй диск. Это еще один шаг. И наконец, опять перенесли один диск, как из предыдущего случая. Всего три шага</p>
  <p>n = 2</p>
  <p>T<sub>n</sub> = T<sub>n-1</sub> + 1 + T<sub>n-1</sub></p>
  <p>T<sub>2</sub> = T<sub>1</sub> + 1 + T<sub>1</sub></p>
  <p>T<sub>2</sub> = 1 + 1 + 1</p>
  <code>n = 2</code>
  <code>T<sub>2</sub> = 3</code>
</article>


<!-- 3 диска -->
<article class="article">
  <div class="anchor" id="han3"></div>
  <h3>3 диска</h3>

<pre>
    |          |          |
   *1*         |          |
  **2**        |          |
 ***3***       |          |
---------  ---------  ---------
</pre>
  <p>Применим ту же закономерность и для случая с тремя дисками. Сначала перенесем два диска, как в предыдущем случае. На это нужно 3 шага. Потом перенесем третий диск - 1 шаг. И наконец, опять перенесем два диска, как из предыдущего случая. Всего 3 + 1 + 3 = 7 шагов</p>

  <h4>3-й шаг</h4>
<pre>
    |          |          |
    |          |          |
    |         *1*         |
 ***3***     **2**        |
---------  ---------  ---------
</pre>

  <h4>4-й шаг</h4>
<pre>
    |          |          |
    |          |          |
    |         *1*         |
    |        **2**     ***3***
---------  ---------  ---------
</pre>

  <h4>7-й шаг</h4>
<pre>
    |          |          |
    |          |         *1*
    |          |        **2**
    |          |       ***3***
---------  ---------  ---------
</pre>
  <p>n = 3</p>
  <p>T<sub>n</sub> = T<sub>n-1</sub> + 1 + T<sub>n-1</sub></p>
  <p>T<sub>3</sub> = T<sub>2</sub> + 1 + T<sub>2</sub></p>
  <p>T<sub>3</sub> = 3 + 1 + 3</p>
  <code>n = 3</code>
  <code>T<sub>3</sub> = 7</code>
</article>


<!-- 4 диска -->
<article class="article">
  <div class="anchor" id="han4"></div>
  <h3>4 диска</h3>

<pre>
     |            |            |
    *1*           |            |
   **2**          |            |
  ***3***         |            |
 ****4****        |            |
-----------  -----------  -----------
</pre>

  <h4>7-й шаг</h4>
<pre>
     |            |            |
     |            |            |
     |           *1*           |
     |          **2**          |
 ****4****     ***3***         |
-----------  -----------  -----------
</pre>

  <h4>8-й шаг</h4>
<pre>
     |            |            |
     |            |            |
     |           *1*           |
     |          **2**          |
     |         ***3***     ****4****
-----------  -----------  -----------
</pre>

  <h4>15-й шаг</h4>
<pre>
     |            |            |
     |            |           *1*
     |            |          **2**
     |            |         ***3***
     |            |        ****4****
-----------  -----------  -----------
</pre>
  <p>n = 4</p>
  <p>T<sub>n</sub> = T<sub>n-1</sub> + 1 + T<sub>n-1</sub></p>
  <p>T<sub>4</sub> = T<sub>3</sub> + 1 + T<sub>3</sub></p>
  <p>T<sub>4</sub> = 7 + 1 + 7</p>
  <code>n = 4</code>
  <code>T<sub>4</sub> = 15</code>
</article>


<!-- n дисков -->
<article class="article">
  <div class="anchor" id="hann"></div>
  <h3>n дисков</h3>

  <p>Для перемещения n дисков, нужно сначала переместить n-1 дисков на второй колышек. Затем переместить нижний самый большой диск на третий колышек. Затем переместить n-1 дисков на него. Причем самый большой диск не будет мешать любым перемещениям остальных дисков потому что на него можно ставить любой диск.</p>
  <p>Алгоритм перемещения n дисков</p>
  <ol>
    <li>Переместить n-1 дисков на второй колышек</li>
    <li>Переместить нижний самый большой диск на третий колышек</li>
    <li>Переместить n-1 дисков на самый большой диск на третьем колышке</li>
  </ol>
</article>


<!-- Рекуррентное соотношение -->
<article class="article">
  <div class="anchor" id="hanr"></div>
  <h3>Рекуррентное соотношение</h3>

  <p><strong>Рекуррентное соотношение</strong> - это система из двух равенств. Первое - это значение для нулевого элемента, а второе это зависимость значения для n элементов от значения для n-1 элементов</p>

  <p>T<sub>n</sub> это число шагов для перекладывания n дисков</p>
  <p>T<sub>n-1</sub> это число шагов для перекладывания n-1 дисков</p>
  <p>T<sub>n</sub> = T<sub>n-1</sub> + 1 + T<sub>n-1</sub></p>
  <p>T<sub>n</sub> = 2T<sub>n-1</sub> + 1</p>
  <p>T<sub>0</sub> это краевой случай для 0 дисков. T<sub>0</sub> = 0</p>

  <p>Напишем систему из двух равенств, которая называется <strong>рекуррентностью</strong></p>
  <code>T<sub>0</sub> = 0</code>
  <code>T<sub>n</sub> = 2T<sub>n-1</sub> + 1</code>
</article>


<!-- Замкнутое выражение -->
<article class="article">
  <div class="anchor" id="hanz"></div>
  <h3>Замкнутое выражение</h3>

  <p><strong>Замкнутое выражение</strong> - это решение рекуррентного соотношения, то есть запись T<sub>n</sub> в простой и компактной "замкнутой" форме. Такая запись позволяет вычислить T<sub>n</sub> быстро даже при большом n</p>
  <p>Прибавим 1 к обоим частям уравнения</p>
  <code>T<sub>0</sub> + 1 = 1</code>
  <code>T<sub>n</sub> + 1 = 2T<sub>n-1</sub> + 2</code>

  <p>Введем новую переменную U<sub>n</sub> = T<sub>n</sub> + 1, тогда получим</p>
  <code>U<sub>0</sub> = 1</code>
  <code>U<sub>n</sub> = 2T<sub>n-1</sub></code>

  <p>Очевидно, что</p>
  <code>U<sub>n</sub> = 2<sup>n</sup></code>

  <p>Тогда <strong>замкнутое выражение</strong> будет</p>
  <code>T<sub>n</sub> = 2<sup>n</sup> - 1</code>

  <p>Теперь можно посчитать число шагов для любого числа дисков. Посчитаем для пяти</p>
  <code>n = 5</code>
  <code>T<sub>5</sub> = 2<sup>5</sup> - 1 = 32 - 1 = 31</code>
</article>


<!-- Как решать задачи с рекуррентностями -->
<article class="article">
  <div class="anchor" id="how"></div>
  <h3>Как решать задачи с рекуррентностями</h3>

  <ol>
    <li>Рассмотреть крайние случаи. Они помогают вникнуть в задачу и проверить следующие этапы</li>
    <li>Посчитать вручную ответ для небольших n</li>
    <li>Найти математическое выражение для интересующей величины - рекуррентность, которая позволяет при заданном n вычислить результат. Чтобы найти такую рекуррентность, рассмотрите задачу для n-1 и выясните, что изменится при переходе к n</li>
    <li>Найти и доказать замкнутое выражение для рекуррентности</li>
  </ol>

  <p>Замкнутое выражение не всегда получается простым для вычисления. А иногда его еще и вовсе невозможно найти. Хорошо, что для написания программы в большинстве случаев замкнутые выражения не понядобятся. Как это работает узнаем в разделе "Вычисление рекуррентностей на компьютере"</p>
</article>

